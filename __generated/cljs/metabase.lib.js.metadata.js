var window=global;var $CLJS=require("./cljs_env.js");require("./cljs.core.js");require("./clojure.core.protocols.js");require("./clojure.string.js");require("./clojure.walk.js");require("./medley.core.js");require("./metabase.lib.metadata.protocols.js");require("./metabase.lib.util.js");require("./metabase.util.js");require("./metabase.util.log.js");
'use strict';var b9,a9,sxa,txa,uxa,i9,vxa,wxa,xxa,k9,yxa,zxa,c9,n9,Axa,p9,Bxa,Cxa,Dxa;$CLJS.$8=function(a,b){return $CLJS.n($CLJS.n(a)?b in a:a)?$CLJS.Da(a,b):null};b9=function(a,b){return a9(a,b,$CLJS.N)};
a9=function(a,b,c){c=$CLJS.O(c);c=$CLJS.J.j(c,c9,!0);if($CLJS.yd(b))return $CLJS.gg.j($CLJS.N,a,b);c=$CLJS.n(c)?function(){var d=$CLJS.$8(b,"_plainObject");d=null==d?null:$CLJS.Iy(d);return null==d?null:$CLJS.Ie(d)}():null;return $CLJS.n(c)?$CLJS.gg.j($CLJS.N,a,c):$CLJS.gg.j($CLJS.N,$CLJS.hk.j($CLJS.kf.h(function(d){return new $CLJS.Q(null,2,5,$CLJS.R,[d,$CLJS.$8(b,d)],null)}),$CLJS.ik.h(function(d){$CLJS.I(d,0,null);return"function"===typeof $CLJS.I(d,1,null)}),a),$CLJS.Ca(b))};
sxa=function(a){var b=d9.h(a),c=e9.h(a),d=f9.h(a);return $CLJS.hk.j($CLJS.kf.h(function(e){var f=$CLJS.I(e,0,null);e=$CLJS.I(e,1,null);var k=$CLJS.R;f=$CLJS.Bh.h(g9(f));if($CLJS.n(d)){var l=d.h?d.h(f):d.call(null,f);f=$CLJS.n(l)?l:f}return new $CLJS.Q(null,2,5,k,[f,e],null)}),$CLJS.ud(b)?$CLJS.Ud:$CLJS.ik.h(function(e){var f=$CLJS.I(e,0,null);$CLJS.I(e,1,null);return $CLJS.Jd(b,f)}),$CLJS.Wa(c)?$CLJS.Ud:$CLJS.kf.h(function(e){var f=$CLJS.I(e,0,null);e=$CLJS.I(e,1,null);return new $CLJS.Q(null,2,5,
$CLJS.R,[f,c.g?c.g(f,e):c.call(null,f,e)],null)}))};txa=function(a){return b9($CLJS.kf.h(function(b){var c=$CLJS.I(b,0,null);b=$CLJS.I(b,1,null);c=$CLJS.Bh.h(g9(c));c=$CLJS.E.g(c,$CLJS.AU)?$CLJS.ED:c;b=$CLJS.E.g(c,$CLJS.ED)?$CLJS.Bh.h(b):b;return new $CLJS.Q(null,2,5,$CLJS.R,[c,b],null)}),a)};
uxa=function(a){var b=$CLJS.rG(function(d){d=$CLJS.$8(d,"type");var e=new $CLJS.ch(null,new $CLJS.h(null,2,["internal",null,"external",null],null),null);return e.h?e.h(d):e.call(null,d)},a);if($CLJS.n(b)){var c=$CLJS.Bh.h($CLJS.$8(b,"type"));return $CLJS.zk.l($CLJS.H([new $CLJS.h(null,2,[$CLJS.Si,$CLJS.$8(b,"id"),$CLJS.U,$CLJS.$8(b,"name")],null),function(){var d=c instanceof $CLJS.M?c.S:null;switch(d){case "external":return new $CLJS.h(null,2,[$CLJS.Us,$CLJS.gK,$CLJS.RJ,$CLJS.$8(b,"human_readable_field_id")],
null);case "internal":return new $CLJS.h(null,1,[$CLJS.Us,$CLJS.aK],null);default:throw Error(["No matching clause: ",$CLJS.p.h(d)].join(""));}}()]))}return null};i9=function(a){return $CLJS.jk.g(h9.g($CLJS.lF,$CLJS.N),a)};
vxa=function(a,b){var c=h9.g($CLJS.tM,new $CLJS.h(null,1,[c9,!1],null)),d=h9.g($CLJS.tM,$CLJS.N);return $CLJS.zk.l($CLJS.H([$CLJS.T.j(function(){var e=$CLJS.$8($CLJS.$8(a,"tables"),["card__",$CLJS.p.h(b)].join(""));return c.h?c.h(e):c.call(null,e)}(),$CLJS.Si,b),function(){var e=$CLJS.$8($CLJS.$8(a,"questions"),$CLJS.p.h(b));var f=$CLJS.$8(e,"_card");e=$CLJS.n(f)?f:e;return d.h?d.h(e):d.call(null,e)}()]))};wxa=new $CLJS.M(null,"plain-object","plain-object",-943264281);
$CLJS.j9=new $CLJS.M(null,"cards","cards",169174038);xxa=new $CLJS.M(null,"binning-info","binning-info",-2117036653);k9=new $CLJS.M("metabase.lib.js.metadata","field-values","metabase.lib.js.metadata/field-values",-88384962);yxa=new $CLJS.M(null,"db","db",993250759);$CLJS.l9=new $CLJS.M(null,"metrics","metrics",394093469);zxa=new $CLJS.M(null,"fks","fks",2041987076);$CLJS.m9=new $CLJS.M(null,"segments","segments",1937535949);c9=new $CLJS.M(null,"use-plain-object?","use-plain-object?",-1174595475);
n9=new $CLJS.M("metabase.lib.js.metadata","dimension","metabase.lib.js.metadata/dimension",2004773191);Axa=new $CLJS.M(null,"metadata","metadata",1799301597);$CLJS.o9=new $CLJS.M(null,"tables","tables",1334623052);p9=new $CLJS.M(null,"dimension-options","dimension-options",2122379680);Bxa=new $CLJS.M(null,"schema-name","schema-name",1666725119);Cxa=new $CLJS.M(null,"_comesFromEndpoint","_comesFromEndpoint",-1390455588);Dxa=new $CLJS.M(null,"default-dimension-option","default-dimension-option",149055958);
$CLJS.q9=new $CLJS.M(null,"databases","databases",2040134125);var g9=$CLJS.Rh($CLJS.Zz),d9,Exa=$CLJS.Ze($CLJS.N),Fxa=$CLJS.Ze($CLJS.N),Gxa=$CLJS.Ze($CLJS.N),Hxa=$CLJS.Ze($CLJS.N),Ixa=$CLJS.J.j($CLJS.N,$CLJS.Jk,$CLJS.Xh.o?$CLJS.Xh.o():$CLJS.Xh.call(null)),t9,Yxa,Zxa,$xa,aya,bya;d9=new $CLJS.fi($CLJS.Hh.g("metabase.lib.js.metadata","excluded-keys"),$CLJS.Bh,Ixa,Exa,Fxa,Gxa,Hxa);d9.m(null,$CLJS.ei,function(){return null});
var e9,Jxa=$CLJS.Ze($CLJS.N),Kxa=$CLJS.Ze($CLJS.N),Lxa=$CLJS.Ze($CLJS.N),Mxa=$CLJS.Ze($CLJS.N),Nxa=$CLJS.J.j($CLJS.N,$CLJS.Jk,$CLJS.Xh.o?$CLJS.Xh.o():$CLJS.Xh.call(null));e9=new $CLJS.fi($CLJS.Hh.g("metabase.lib.js.metadata","parse-field-fn"),$CLJS.Bh,Nxa,Jxa,Kxa,Lxa,Mxa);e9.m(null,$CLJS.ei,function(){return null});var r9,Oxa=$CLJS.Ze($CLJS.N),Pxa=$CLJS.Ze($CLJS.N),Qxa=$CLJS.Ze($CLJS.N),Rxa=$CLJS.Ze($CLJS.N),Sxa=$CLJS.J.j($CLJS.N,$CLJS.Jk,$CLJS.Xh.o?$CLJS.Xh.o():$CLJS.Xh.call(null));
r9=new $CLJS.fi($CLJS.Hh.g("metabase.lib.js.metadata","lib-type"),$CLJS.Bh,Sxa,Oxa,Pxa,Qxa,Rxa);var f9,Txa=$CLJS.Ze($CLJS.N),Uxa=$CLJS.Ze($CLJS.N),Vxa=$CLJS.Ze($CLJS.N),Wxa=$CLJS.Ze($CLJS.N),Xxa=$CLJS.J.j($CLJS.N,$CLJS.Jk,$CLJS.Xh.o?$CLJS.Xh.o():$CLJS.Xh.call(null));f9=new $CLJS.fi($CLJS.Hh.g("metabase.lib.js.metadata","rename-key-fn"),$CLJS.Ud,Xxa,Txa,Uxa,Vxa,Wxa);f9.m(null,$CLJS.ei,function(){return null});
var h9=function(){var a=$CLJS.Ze($CLJS.N),b=$CLJS.Ze($CLJS.N),c=$CLJS.Ze($CLJS.N),d=$CLJS.Ze($CLJS.N),e=$CLJS.J.j($CLJS.N,$CLJS.Jk,$CLJS.Xh.o?$CLJS.Xh.o():$CLJS.Xh.call(null));return new $CLJS.fi($CLJS.Hh.g("metabase.lib.js.metadata","parse-object-fn*"),function(f){return f},e,a,b,c,d)}();
h9.m(null,$CLJS.ei,function(a,b){var c=sxa(a),d=r9.h(a);return function(e){try{var f=$CLJS.T.j(a9(c,e,b),$CLJS.Us,d),k=$CLJS.Gz($CLJS.wx);$CLJS.n($CLJS.Fz("metabase.lib.js.metadata",k))&&$CLJS.Ez("metabase.lib.js.metadata",k,$CLJS.sV("Parsed metadata %s %s\n%s",$CLJS.H([a,$CLJS.Si.h(f),$CLJS.tV(f)])),null);return f}catch(l){if(l instanceof Error)return f=l,k=$CLJS.Gz($CLJS.xx),$CLJS.n($CLJS.Fz("metabase.lib.js.metadata",k))&&(f instanceof Error?$CLJS.Ez("metabase.lib.js.metadata",k,$CLJS.sV("Error parsing %s %s: %s",
$CLJS.H([a,$CLJS.Oh.l($CLJS.H([e])),$CLJS.qU(f)])),f):$CLJS.Ez("metabase.lib.js.metadata",k,$CLJS.sV(f,$CLJS.H(["Error parsing %s %s: %s",a,$CLJS.Oh.l($CLJS.H([e])),$CLJS.qU(f)])),null)),null;throw l;}}});$CLJS.s9=function(){var a=$CLJS.Ze($CLJS.N),b=$CLJS.Ze($CLJS.N),c=$CLJS.Ze($CLJS.N),d=$CLJS.Ze($CLJS.N),e=$CLJS.J.j($CLJS.N,$CLJS.Jk,$CLJS.Xh.o?$CLJS.Xh.o():$CLJS.Xh.call(null));return new $CLJS.fi($CLJS.Hh.g("metabase.lib.js.metadata","parse-objects"),function(f){return $CLJS.Bh.h(f)},e,a,b,c,d)}();
Yxa=$CLJS.Ze($CLJS.N);Zxa=$CLJS.Ze($CLJS.N);$xa=$CLJS.Ze($CLJS.N);aya=$CLJS.Ze($CLJS.N);bya=$CLJS.J.j($CLJS.N,$CLJS.Jk,$CLJS.Xh.o?$CLJS.Xh.o():$CLJS.Xh.call(null));t9=new $CLJS.fi($CLJS.Hh.g("metabase.lib.js.metadata","parse-objects-default-key"),$CLJS.Bh,bya,Yxa,Zxa,$xa,aya);
$CLJS.s9.m(null,$CLJS.ei,function(a,b){var c=h9.g(a,$CLJS.N);return b9($CLJS.kf.h(function(d){var e=$CLJS.I(d,0,null),f=$CLJS.I(d,1,null);return new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.rV(e),new $CLJS.Lh(function(){return c.h?c.h(f):c.call(null,f)})],null)}),$CLJS.$8(b,t9.h(a)))});r9.m(null,$CLJS.SO,function(){return $CLJS.cK});d9.m(null,$CLJS.SO,function(){return new $CLJS.ch(null,new $CLJS.h(null,2,[$CLJS.TD,null,$CLJS.o9,null],null),null)});
e9.m(null,$CLJS.SO,function(){return function(a,b){switch(a instanceof $CLJS.M?a.S:null){case "dbms-version":return $CLJS.Hy(b,$CLJS.H([$CLJS.yi,!0]));case "features":return $CLJS.gg.j($CLJS.dh,$CLJS.kf.h($CLJS.Bh),b);case "native-permissions":return $CLJS.Bh.h(b);default:return b}}});t9.m(null,$CLJS.SO,function(){return"databases"});r9.m(null,$CLJS.MV,function(){return $CLJS.OJ});
d9.m(null,$CLJS.MV,function(){return new $CLJS.ch(null,new $CLJS.h(null,5,[p9,null,$CLJS.TD,null,$CLJS.m9,null,$CLJS.SO,null,$CLJS.l9,null],null),null)});e9.m(null,$CLJS.MV,function(){return function(a,b){switch(a instanceof $CLJS.M?a.S:null){case "entity-type":return $CLJS.Bh.h(b);case "field-order":return $CLJS.Bh.h(b);case "initial-sync-status":return $CLJS.Bh.h(b);case "visibility-type":return $CLJS.Bh.h(b);default:return b}}});
$CLJS.s9.m(null,$CLJS.MV,function(a,b){var c=h9.g(a,$CLJS.N);return b9($CLJS.hk.g($CLJS.ik.h(function(d){var e=$CLJS.I(d,0,null);$CLJS.I(d,1,null);return 0==e.lastIndexOf("card__",0)}),$CLJS.kf.h(function(d){var e=$CLJS.I(d,0,null),f=$CLJS.I(d,1,null);return new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.rV(e),new $CLJS.Lh(function(){return c.h?c.h(f):c.call(null,f)})],null)})),$CLJS.$8(b,"tables"))});r9.m(null,$CLJS.lF,function(){return $CLJS.GJ});
d9.m(null,$CLJS.lF,function(){return new $CLJS.ch(null,new $CLJS.h(null,6,[p9,null,$CLJS.MV,null,Dxa,null,$CLJS.SO,null,Cxa,null,$CLJS.l9,null],null),null)});f9.m(null,$CLJS.lF,function(){return new $CLJS.h(null,6,[$CLJS.Vy,$CLJS.IJ,$CLJS.Ek,$CLJS.HV,$CLJS.XQ,$CLJS.rD,xxa,$CLJS.NV,$CLJS.FK,n9,$CLJS.Rr,k9],null)});
e9.m(null,$CLJS.lF,function(){return function(a,b){switch(a instanceof $CLJS.M?a.S:null){case "base-type":return $CLJS.Bh.h(b);case "coercion-strategy":return $CLJS.Bh.h(b);case "effective-type":return $CLJS.Bh.h(b);case "fingerprint":return $CLJS.yd(b)?$CLJS.tU(b):$CLJS.Hy(b,$CLJS.H([$CLJS.yi,!0]));case "has-field-values":return $CLJS.Bh.h(b);case "lib/source":switch(b){case "aggregation":return $CLJS.hK;case "breakout":return $CLJS.ZJ;default:return $CLJS.Bh.g("source",b)}case "metabase.lib.field/temporal-unit":return $CLJS.Bh.h(b);
case "semantic-type":return $CLJS.Bh.h(b);case "visibility-type":return $CLJS.Bh.h(b);case "id":return $CLJS.Ad(b)?$CLJS.id(b):b;case "metabase.lib.field/binning":return txa(b);case "metabase.lib.js.metadata/field-values":return $CLJS.E.g($CLJS.$8(b,"type"),"full")?new $CLJS.h(null,2,[$CLJS.Rr,$CLJS.Iy($CLJS.$8(b,"values")),$CLJS.NJ,$CLJS.Iy($CLJS.$8(b,"human_readable_values"))],null):null;case "metabase.lib.js.metadata/dimension":return uxa(b);default:return b}}});
h9.m(null,$CLJS.lF,function(a,b){var c=function(){var d=$CLJS.kH(h9,$CLJS.ei);return d.g?d.g(a,b):d.call(null,a,b)}();return function(d){d=c.h?c.h(d):c.call(null,d);var e=$CLJS.O(d);d=$CLJS.J.g(e,n9);var f=$CLJS.O(d),k=$CLJS.J.g(f,$CLJS.Us),l=$CLJS.J.g(e,k9);return $CLJS.ak.l(function(){switch(k instanceof $CLJS.M?k.S:null){case "metadata.column.remapping/external":return $CLJS.T.j(e,$CLJS.VJ,f);case "metadata.column.remapping/internal":return $CLJS.T.j(e,$CLJS.bK,$CLJS.zk.l($CLJS.H([f,l])));default:return e}}(),
n9,$CLJS.H([k9]))}});
$CLJS.s9.m(null,$CLJS.lF,function(a,b){var c=h9.g(a,$CLJS.N),d=$CLJS.$8(b,"fields");return b9($CLJS.zl(function(e){var f=$CLJS.I(e,0,null),k=$CLJS.I(e,1,null);e=function(){var l=$CLJS.rV(f);if($CLJS.n(l))return l;l=$CLJS.ph(/card__\d+:(\d+)/,f);if($CLJS.n(l)){$CLJS.I(l,0,null);l=$CLJS.I(l,1,null);var m=null==$CLJS.$8(d,l);return m?$CLJS.rV(l):m}return null}();return $CLJS.n(e)?new $CLJS.Q(null,2,5,$CLJS.R,[e,new $CLJS.Lh(function(){return c.h?c.h(k):c.call(null,k)})],null):null}),d)});
r9.m(null,$CLJS.tM,function(){return $CLJS.fK});d9.m(null,$CLJS.tM,function(){return new $CLJS.ch(null,new $CLJS.h(null,11,[p9,null,$CLJS.Uk,null,zxa,null,$CLJS.MV,null,yxa,null,wxa,null,$CLJS.m9,null,$CLJS.SO,null,Axa,null,$CLJS.l9,null,Bxa,null],null),null)});
e9.m(null,$CLJS.tM,function(){return function(a,b){switch(a instanceof $CLJS.M?a.S:null){case "result-metadata":return $CLJS.n($CLJS.uz($CLJS.xd,$CLJS.Va)(b))?i9(b):$CLJS.Hy(b,$CLJS.H([$CLJS.yi,!0]));case "fields":return i9(b);case "visibility-type":return $CLJS.Bh.h(b);case "dataset-query":return $CLJS.Hy(b,$CLJS.H([$CLJS.yi,!0]));case "dataset":return b;default:return b}}});
$CLJS.s9.m(null,$CLJS.tM,function(a,b){return $CLJS.gg.j($CLJS.N,$CLJS.kf.h(function(c){return new $CLJS.Q(null,2,5,$CLJS.R,[c,new $CLJS.Lh(function(){return vxa(b,c)})],null)}),$CLJS.gg.j($CLJS.gg.j($CLJS.dh,$CLJS.zl($CLJS.EV),$CLJS.Ca($CLJS.$8(b,"tables"))),$CLJS.kf.h($CLJS.rV),$CLJS.Ca($CLJS.$8(b,"questions"))))});r9.m(null,$CLJS.gF,function(){return $CLJS.MJ});d9.m(null,$CLJS.gF,function(){return new $CLJS.ch(null,new $CLJS.h(null,2,[$CLJS.MV,null,$CLJS.SO,null],null),null)});
e9.m(null,$CLJS.gF,function(){return function(a,b){return b}});t9.m(null,$CLJS.gF,function(){return"metrics"});r9.m(null,$CLJS.JE,function(){return $CLJS.KJ});d9.m(null,$CLJS.JE,function(){return new $CLJS.ch(null,new $CLJS.h(null,2,[$CLJS.MV,null,$CLJS.SO,null],null),null)});e9.m(null,$CLJS.JE,function(){return function(a,b){return b}});t9.m(null,$CLJS.JE,function(){return"segments"});$CLJS.u9=h9.g($CLJS.lF,$CLJS.N);