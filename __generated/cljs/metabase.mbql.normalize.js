var window=global;var $CLJS=require("./cljs_env.js");require("./cljs.core.js");require("./clojure.set.js");require("./clojure.walk.js");require("./medley.core.js");require("./metabase.mbql.util.js");require("./metabase.mbql.util.match.js");require("./metabase.shared.util.i18n.js");require("./metabase.util.log.js");require("./metabase.util.malli.js");
'use strict';var VV,Ema,XV,ZV,$V,Fma,bW,cW,UV,dW,Gma,Hma,Ima,Jma,gW,hW,jW,kW,lW,mW,nW,oW,WV,Lma,Mma,rW,Nma,sW,Oma,uW,Pma,Qma,Rma,Sma,Tma,RV;$CLJS.SV=function(a,b){if("string"===typeof b)return RV(a,b);throw new TypeError("re-seq must match against a string.");};$CLJS.TV=function(a,b,c){var d=$CLJS.Jl(a,b);if($CLJS.n(d)){var e=$CLJS.T.j;d=$CLJS.Gb(d);c=c.h?c.h(d):c.call(null,d);a=e.call($CLJS.T,a,b,c)}return a};
VV=function(a){var b=UV;return $CLJS.Cz(function(c){return function(d,e,f){e=b.h?b.h(e):b.call(null,e);return c.j?c.j(d,e,f):c.call(null,d,e,f)}},a)};Ema=function(a){var b=WV;return $CLJS.Cz(function(c){return function(d,e,f){f=b.h?b.h(f):b.call(null,f);return c.j?c.j(d,e,f):c.call(null,d,e,f)}},a)};XV=function(a){if($CLJS.nd(a))return a;throw $CLJS.ji("Invalid pattern: don't know how to handle symbol.",new $CLJS.h(null,1,[$CLJS.Di,a],null));};
$CLJS.YV=function(a,b,c){return $CLJS.yd(c)?$CLJS.gg.g(c,function(){return function f(e){return new $CLJS.pe(null,function(){for(;;){var k=$CLJS.y(e);if(k){if($CLJS.Bd(k)){var l=$CLJS.mc(k),m=$CLJS.D(l),t=$CLJS.se(m);return function(){for(var A=0;;)if(A<m){var C=$CLJS.ld(l,A),G=$CLJS.I(C,0,null),K=$CLJS.I(C,1,null);C=t;var S=$CLJS.R,X=G;G=$CLJS.de.g(b,G);G=a.g?a.g(G,K):a.call(null,G,K);C.add(new $CLJS.Q(null,2,5,S,[X,G],null));A+=1}else return!0}()?$CLJS.ve($CLJS.xe(t),f($CLJS.nc(k))):$CLJS.ve($CLJS.xe(t),
null)}var u=$CLJS.z(k),v=$CLJS.I(u,0,null),x=$CLJS.I(u,1,null);return $CLJS.ge(new $CLJS.Q(null,2,5,$CLJS.R,[v,function(){var A=$CLJS.de.g(b,v),C=x;return a.g?a.g(A,C):a.call(null,A,C)}()],null),f($CLJS.Mc(k)))}return null}},null,null)}(c)}()):$CLJS.xd(c)?$CLJS.jk.g($CLJS.Xe(a,$CLJS.z(c)instanceof $CLJS.M?$CLJS.de.g(b,$CLJS.z(c)):b),c):c};ZV=function(a){var b=(b=a instanceof $CLJS.M)?$CLJS.ke(a):b;return $CLJS.n(b)?[$CLJS.ke(a),"/",$CLJS.ih(a)].join(""):$CLJS.ih(a)};
$V=function(a,b){var c=$CLJS.xd(b)&&!$CLJS.Bf(b)&&$CLJS.z(b)instanceof $CLJS.M;return c?$CLJS.vd(a)?(b=$CLJS.z(b),a=$CLJS.hh(a),a.h?a.h(b):a.call(null,b)):$CLJS.E.g(a,$CLJS.z(b)):c};
Fma=function(a,b){return $CLJS.lf(function(c){var d=$CLJS.nf;a:try{if($CLJS.Ad(c)&&1<=$CLJS.D(c))try{var e=$CLJS.ok.j(c,0,1);if($CLJS.Ad(e)&&1===$CLJS.D(e))try{var f=$CLJS.F(e,0);if($CLJS.n($CLJS.Xe($CLJS.E,a)(f))){var k=$CLJS.ok.g(c,1);var l=new $CLJS.Q(null,1,5,$CLJS.R,[k],null)}else throw $CLJS.Z;}catch(t){if(t instanceof Error){var m=t;if(m===$CLJS.Z)throw $CLJS.Z;throw m;}throw t;}else throw $CLJS.Z;}catch(t){if(t instanceof Error){m=t;if(m===$CLJS.Z)throw $CLJS.Z;throw m;}throw t;}else throw $CLJS.Z;
}catch(t){if(t instanceof Error){m=t;if(m===$CLJS.Z){l=new $CLJS.Q(null,1,5,$CLJS.R,[new $CLJS.Q(null,1,5,$CLJS.R,[c],null)],null);break a}throw m;}throw t;}return $CLJS.z($CLJS.y(d($CLJS.Ya,l)))},$CLJS.H([b]))};
bW=function(a,b){for(;;)switch(b=$CLJS.Ak.h($CLJS.nf($CLJS.Ya,b)),$CLJS.D(b)){case 0:return null;case 1:return a=$CLJS.z(b),aW.h?aW.h(a):aW.call(null,a);default:if($CLJS.n($CLJS.Ue($CLJS.Xe($V,a),b))){var c=a;b=Fma(a,b);a=c}else{c=$CLJS.kf.g(aW,b);if($CLJS.E.g(c,b))return $CLJS.gg.g(new $CLJS.Q(null,1,5,$CLJS.R,[a],null),b);b=c}}};cW=function(a){var b=$CLJS.xd(a);return b?(b=!$CLJS.Bf(a))?$CLJS.uz($CLJS.ie,$CLJS.$a)($CLJS.z(a)):b:b};
UV=function(a){return $CLJS.n($CLJS.uz($CLJS.ie,$CLJS.$a)(a))?$CLJS.Bh.h($CLJS.Az(ZV(a).toLowerCase(),/_/,"-")):a};dW=function(a,b){var c=cW(b);return $CLJS.n(c)?(b=UV($CLJS.z(b)),$CLJS.vd(a)?(a=$CLJS.hh(a),a.h?a.h(b):a.call(null,b)):$CLJS.E.g(a,b)):c};Gma=function(a){return $CLJS.J.j(new $CLJS.h(null,3,[$CLJS.ei,$CLJS.Ud,$CLJS.aj,UV,$CLJS.OM,UV],null),a,function(b){var c=$CLJS.J,d=c.g;b=$CLJS.He([a,b]);b=eW.g?eW.g(b,fW):eW.call(null,b,fW);return d.call(c,b,a)})};
Hma=function(a){a=$CLJS.gg.j($CLJS.N,$CLJS.kf.h(function(b){var c=$CLJS.I(b,0,null);b=$CLJS.I(b,1,null);c=UV(c);var d=Gma(c);return new $CLJS.Q(null,2,5,$CLJS.R,[c,d.h?d.h(b):d.call(null,b)],null)}),a);return $CLJS.E.g($CLJS.aj.h(a),$CLJS.EE)&&$CLJS.Wa($CLJS.OM.h(a))?$CLJS.T.j(a,$CLJS.OM,$CLJS.DF):a};Ima=function(a){return $CLJS.gg.j($CLJS.N,$CLJS.kf.h(function(b){var c=$CLJS.I(b,0,null);b=$CLJS.I(b,1,null);c=ZV(c);return new $CLJS.Q(null,2,5,$CLJS.R,[c,$CLJS.T.j(Hma(b),$CLJS.U,c)],null)}),a)};
Jma=function(a){a=eW.h?eW.h(a):eW.call(null,a);return WV.h?WV.h(a):WV.call(null,a)};gW=function(a){return $CLJS.TV($CLJS.TV($CLJS.fb(function(b,c){return $CLJS.TV(b,c,$CLJS.Bh)},a,new $CLJS.Q(null,6,5,$CLJS.R,[$CLJS.bC,$CLJS.cga,$CLJS.BN,Kma,$CLJS.Vy,$CLJS.Ek],null)),$CLJS.aB,Jma),$CLJS.QM,$CLJS.tU)};hW=function(a){return $CLJS.Gd(a)?new $CLJS.Q(null,3,5,$CLJS.R,[$CLJS.lF,a,null],null):a};jW=function(a){return iW.h(hW(a))};
kW=function(a){var b=$CLJS.y(a);a=$CLJS.z(b);b=$CLJS.B(b);return aW($CLJS.gg.g(new $CLJS.Q(null,1,5,$CLJS.R,[a],null),$CLJS.kf.g(iW,b)))};lW=function(a){var b=$CLJS.y(a);a=$CLJS.z(b);var c=$CLJS.B(b);b=$CLJS.z(c);c=$CLJS.B(c);return $CLJS.gg.g(new $CLJS.Q(null,2,5,$CLJS.R,[a,jW(b)],null),$CLJS.kf.g(iW,c))};mW=function(a){var b=$CLJS.I(a,0,null);a=$CLJS.I(a,1,null);return $CLJS.n(a)?new $CLJS.Q(null,2,5,$CLJS.R,[b,jW(a)],null):new $CLJS.Q(null,1,5,$CLJS.R,[b],null)};
nW=function(a){var b=$CLJS.I(a,0,null);a=$CLJS.I(a,1,null);return new $CLJS.Q(null,2,5,$CLJS.R,[b,jW(a)],null)};oW=function(a){var b=$CLJS.I(a,0,null);a=$CLJS.I(a,1,null);return new $CLJS.Q(null,2,5,$CLJS.R,[b,iW.h(a)],null)};
WV=function(a){return pW(function(b){if($CLJS.yd(b))return Ema(b);if($CLJS.Wa(cW(b)))return b;try{return iW.h(b)}catch(f){if(f instanceof Error){var c=f,d=$CLJS.Gz($CLJS.xx);if($CLJS.n($CLJS.Fz("metabase.mbql.normalize",d))){var e=$CLJS.LD("Invalid clause:");e instanceof Error?$CLJS.Ez("metabase.mbql.normalize",d,$CLJS.vv.l($CLJS.H([b])),e):$CLJS.Ez("metabase.mbql.normalize",d,$CLJS.vv.l($CLJS.H([e,b])),null)}throw $CLJS.ii($CLJS.iD("Invalid MBQL clause: {0}",$CLJS.H([$CLJS.qU(c)])),new $CLJS.h(null,
1,[$CLJS.WQ,b],null),c);}throw f;}},a)};Lma=function(a){return $CLJS.Ff($CLJS.Fl(WV,qW(a)))};Mma=function(a){for(;;)if($CLJS.n(cW(a)))a=new $CLJS.Q(null,1,5,$CLJS.R,[a],null);else return $CLJS.Ie($CLJS.jk.g(hW,a))};rW=function(a){a=$CLJS.O(a);var b=$CLJS.J.g(a,$CLJS.EE);return $CLJS.n(b)?$CLJS.kk.j(a,$CLJS.EE,iW):a};
Nma=function(a){return $CLJS.gg.g($CLJS.N,function(){return function d(c){return new $CLJS.pe(null,function(){for(;;){var e=$CLJS.y(c);if(e){if($CLJS.Bd(e)){var f=$CLJS.mc(e),k=$CLJS.D(f),l=$CLJS.se(k);a:for(var m=0;;)if(m<k){var t=$CLJS.ld(f,m),u=$CLJS.I(t,0,null);t=$CLJS.I(t,1,null);u=new $CLJS.Q(null,2,5,$CLJS.R,[u,rW(t)],null);l.add(u);m+=1}else{f=!0;break a}return f?$CLJS.ve($CLJS.xe(l),d($CLJS.nc(e))):$CLJS.ve($CLJS.xe(l),null)}f=$CLJS.z(e);l=$CLJS.I(f,0,null);f=$CLJS.I(f,1,null);return $CLJS.ge(new $CLJS.Q(null,
2,5,$CLJS.R,[l,rW(f)],null),d($CLJS.Mc(e)))}return null}},null,null)}(a)}())};sW=function(a){a=$CLJS.O(a);var b=$CLJS.J.g(a,$CLJS.DP);return $CLJS.n(b)?$CLJS.kk.j(a,$CLJS.DP,Nma):a};Oma=function(a){var b=$CLJS.O(a);a=$CLJS.J.g(b,$CLJS.gP);b=$CLJS.Wa(a)?tW.h?tW.h(b):tW.call(null,b):b;return $CLJS.n(a)?sW(b):b};uW=function(a){return $CLJS.vd(a)?$CLJS.y(a):null!=a};
Pma=function(a){var b=$CLJS.O(a);a=$CLJS.J.g(b,$CLJS.HE);var c=$CLJS.J.g(b,$CLJS.sM),d=$CLJS.J.g(b,$CLJS.PN),e=$CLJS.J.g(b,$CLJS.gP);try{if($CLJS.n(d)){var f=$CLJS.O(b),k=$CLJS.J.g(f,$CLJS.PN);var l=$CLJS.UK($CLJS.ak.g(f,$CLJS.PN),new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.HE,$CLJS.PN],null),k)}else l=b;var m=$CLJS.n(a)?$CLJS.kk.j(l,$CLJS.HE,tW):l,t=$CLJS.n(c)?$CLJS.kk.j(m,$CLJS.sM,$CLJS.Xe($CLJS.jk,WV)):m,u=$CLJS.n(e)?$CLJS.kk.j(t,$CLJS.gP,sW):t;return WV(u)}catch(v){if(v instanceof Error)throw m=v,$CLJS.ii($CLJS.iD("Error canonicalizing query: {0}",
$CLJS.H([$CLJS.qU(m)])),new $CLJS.h(null,1,[$CLJS.HE,a],null),m);throw v;}};
Qma=function(a){a=$CLJS.O(a);var b=$CLJS.J.g(a,$CLJS.HE),c=$CLJS.O(b);b=$CLJS.J.g(c,$CLJS.$E);c=$CLJS.J.g(c,$CLJS.TD);return $CLJS.y(b)&&$CLJS.y(c)?(b=$CLJS.gg.j($CLJS.dh,$CLJS.mB,$CLJS.y($CLJS.nf($CLJS.Ya,function k(e,f){try{if($CLJS.Ad(f)&&3===$CLJS.D(f))try{var l=$CLJS.F(f,0);if($CLJS.je(l,$CLJS.lF)){var m=$CLJS.F(f,1),t=$CLJS.F(f,2);return new $CLJS.Q(null,1,5,$CLJS.R,[new $CLJS.Q(null,2,5,$CLJS.R,[f,new $CLJS.Q(null,3,5,$CLJS.R,[$CLJS.lF,m,$CLJS.ak.g(t,$CLJS.rF)],null)],null)],null)}throw $CLJS.Z;
}catch(u){if(u instanceof Error){l=u;if(l===$CLJS.Z)throw $CLJS.Z;throw l;}throw u;}else throw $CLJS.Z;}catch(u){if(u instanceof Error){l=u;if(l===$CLJS.Z)return $CLJS.yU(k,e,f);throw l;}throw u;}}($CLJS.Ef,b)))),$CLJS.vW.j(a,new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.HE,$CLJS.TD],null),$CLJS.hk.g($CLJS.Ff,$CLJS.Xe($CLJS.ik,b)))):a};
Rma=function(a){try{return Qma(a)}catch(c){if(c instanceof Error){var b=c;throw $CLJS.ii($CLJS.LD("Error performing whole query transformations"),new $CLJS.h(null,1,[$CLJS.HE,a],null),b);}throw c;}};
Sma=function(a,b){var c=$CLJS.gg.g($CLJS.kd(a),function(){return function f(e){return new $CLJS.pe(null,function(){for(var k=e;;)if(k=$CLJS.y(k)){if($CLJS.Bd(k)){var l=$CLJS.mc(k),m=$CLJS.D(l),t=$CLJS.se(m);return function(){for(var A=0;;)if(A<m){var C=$CLJS.ld(l,A),G=$CLJS.I(C,0,null);C=$CLJS.I(C,1,null);var K=$CLJS.de.g(b,G);C=wW.g?wW.g(C,K):wW.call(null,C,K);null!=C&&t.add(new $CLJS.Q(null,2,5,$CLJS.R,[G,C],null));A+=1}else return!0}()?$CLJS.ve($CLJS.xe(t),f($CLJS.nc(k))):$CLJS.ve($CLJS.xe(t),
null)}var u=$CLJS.z(k),v=$CLJS.I(u,0,null),x=$CLJS.I(u,1,null);u=function(){var A=x,C=$CLJS.de.g(b,v);return wW.g?wW.g(A,C):wW.call(null,A,C)}();if(null!=u)return $CLJS.ge(new $CLJS.Q(null,2,5,$CLJS.R,[v,u],null),f($CLJS.Mc(k)));k=$CLJS.Mc(k)}else return null},null,null)}(a)}());return $CLJS.y(c)?c:null};Tma=function(a,b){a=$CLJS.jk.g(function(c){var d=$CLJS.de.g(b,xW);return wW.g?wW.g(c,d):wW.call(null,c,d)},a);return $CLJS.n($CLJS.Ue($CLJS.Ya,a))?a:null};
RV=function RV(a,b){var d=a.exec(b);if(null==d)return null;var e=d[0],f=1===d.length?e:$CLJS.Ff(d);return $CLJS.ge(f,new $CLJS.pe(null,function(){var k=e.length;k=d.index+(1>k?1:k);return k<=b.length?(k=b.substring(k),RV.g?RV.g(a,k):RV.call(null,a,k)):null},null,null))};
$CLJS.vW=function vW(a){switch(arguments.length){case 3:return vW.j(arguments[0],arguments[1],arguments[2]);case 4:return vW.v(arguments[0],arguments[1],arguments[2],arguments[3]);case 5:return vW.M(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]);case 6:return vW.W(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return vW.l(arguments[0],arguments[1],arguments[2],
arguments[3],arguments[4],arguments[5],new $CLJS.w(c.slice(6),0,null))}};$CLJS.vW.j=function(a,b,c){var d=$CLJS.y(b);b=$CLJS.z(d);if(d=$CLJS.B(d))a=$CLJS.T.j(a,b,$CLJS.vW.j($CLJS.J.g(a,b),d,c));else{d=$CLJS.T.j;var e=$CLJS.J.g(a,b);c=c.h?c.h(e):c.call(null,e);a=d.call($CLJS.T,a,b,c)}return a};
$CLJS.vW.v=function(a,b,c,d){var e=$CLJS.y(b);b=$CLJS.z(e);if(e=$CLJS.B(e))a=$CLJS.T.j(a,b,$CLJS.vW.v($CLJS.J.g(a,b),e,c,d));else{e=$CLJS.T.j;var f=$CLJS.J.g(a,b);c=c.g?c.g(f,d):c.call(null,f,d);a=e.call($CLJS.T,a,b,c)}return a};$CLJS.vW.M=function(a,b,c,d,e){var f=$CLJS.y(b);b=$CLJS.z(f);if(f=$CLJS.B(f))a=$CLJS.T.j(a,b,$CLJS.vW.M($CLJS.J.g(a,b),f,c,d,e));else{f=$CLJS.T.j;var k=$CLJS.J.g(a,b);c=c.j?c.j(k,d,e):c.call(null,k,d,e);a=f.call($CLJS.T,a,b,c)}return a};
$CLJS.vW.W=function(a,b,c,d,e,f){var k=$CLJS.y(b);b=$CLJS.z(k);if(k=$CLJS.B(k))a=$CLJS.T.j(a,b,$CLJS.vW.W($CLJS.J.g(a,b),k,c,d,e,f));else{k=$CLJS.T.j;var l=$CLJS.J.g(a,b);c=c.v?c.v(l,d,e,f):c.call(null,l,d,e,f);a=k.call($CLJS.T,a,b,c)}return a};$CLJS.vW.l=function(a,b,c,d,e,f,k){var l=$CLJS.y(b);b=$CLJS.z(l);return(l=$CLJS.B(l))?$CLJS.T.j(a,b,$CLJS.P.l($CLJS.vW,$CLJS.J.g(a,b),l,c,d,$CLJS.H([e,f,k]))):$CLJS.T.j(a,b,$CLJS.P.l(c,$CLJS.J.g(a,b),d,e,f,$CLJS.H([k])))};
$CLJS.vW.B=function(a){var b=$CLJS.z(a),c=$CLJS.B(a);a=$CLJS.z(c);var d=$CLJS.B(c);c=$CLJS.z(d);var e=$CLJS.B(d);d=$CLJS.z(e);var f=$CLJS.B(e);e=$CLJS.z(f);var k=$CLJS.B(f);f=$CLJS.z(k);k=$CLJS.B(k);return this.l(b,a,c,d,e,f,k)};$CLJS.vW.A=6;
var pW=function pW(a,b){return $CLJS.rU($CLJS.Xe(pW,a),$CLJS.Ud,a.h?a.h(b):a.call(null,b))},aW=function aW(a){for(;;){if($CLJS.yd(a))return $CLJS.fs(a,aW);if($CLJS.Ed(a))a=$CLJS.Ff(a);else if($CLJS.Ad(a)){if($CLJS.Wa($CLJS.Ue($CLJS.Ya,a)))return null;var c=a,d=$CLJS.y(c),e=$CLJS.z(d),f=$CLJS.B(d),k=e,l=f,m=$CLJS.I(l,0,null),t=l,u=k,v=u instanceof $CLJS.M?u.S:null;switch(v){case "not":if($CLJS.ol(m)){var x=$CLJS.z(m),A=x instanceof $CLJS.M?x.S:null;switch(A){case "not":a=$CLJS.id(m);continue;case "and":return bW($CLJS.fr,
$CLJS.kf.g(function(){return function(C){return new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.hr,C],null)}}(a,x,A,u,v,c,d,e,f,k,l,m,t),$CLJS.Mc(m)));case "or":return bW($CLJS.mr,$CLJS.kf.g(function(){return function(C){return new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.hr,C],null)}}(a,x,A,u,v,c,d,e,f,k,l,m,t),$CLJS.Mc(m)));default:return a}}else return a;case "and":return bW($CLJS.mr,t);case "or":return bW($CLJS.fr,t);default:return $CLJS.jk.g(aW,a)}}else return a}},Uma=new $CLJS.M(null,"value_field","value_field",
-980977878),yW=new $CLJS.M(null,"ascending","ascending",-988350486),zW=new $CLJS.M(null,"named","named",-422393479),AW=new $CLJS.M(null,"values_source_config","values_source_config",-590570309),BW=new $CLJS.M(null,"descending","descending",-24766135),CW=new $CLJS.M(null,"datetime-field","datetime-field",21731696),Vma=new $CLJS.M(null,"use-as-display-name?","use-as-display-name?",686752941),DW=new $CLJS.M(null,"field-literal","field-literal",-1295883554),EW=new $CLJS.M(null,"viz-settings","viz-settings",
256055379),Wma=new $CLJS.M(null,"rows","rows",850049680),Xma=new $CLJS.M(null,"special-fn","special-fn",1290649344),xW=new $CLJS.M("metabase.mbql.normalize","sequence","metabase.mbql.normalize/sequence",-1700645683),fW=new $CLJS.M(null,"ignore-path","ignore-path",944069061),Yma=new $CLJS.M(null,"label_field","label_field",-1573182765),Zma=new $CLJS.M(null,"fk-\x3e","fk-\x3e",-499026738),$ma=new $CLJS.M(null,"joined-field","joined-field",-2048778268),Kma=new $CLJS.M(null,"visibility_type","visibility_type",
-508434247);var FW,ana=$CLJS.Ze($CLJS.N),bna=$CLJS.Ze($CLJS.N),cna=$CLJS.Ze($CLJS.N),dna=$CLJS.Ze($CLJS.N),ena=$CLJS.J.j($CLJS.N,$CLJS.Jk,$CLJS.Xh.o?$CLJS.Xh.o():$CLJS.Xh.call(null));FW=new $CLJS.fi($CLJS.Hh.g("metabase.mbql.normalize","normalize-mbql-clause-tokens"),$CLJS.hk.g(UV,$CLJS.z),ena,ana,bna,cna,dna);FW.m(null,$CLJS.aF,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);b=new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.aF,b],null);return null!=a?$CLJS.de.g(b,a):b});
FW.m(null,$CLJS.kA,function(a){$CLJS.I(a,0,null);a=$CLJS.I(a,1,null);return new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.kA,a instanceof $CLJS.M?ZV(a):a],null)});FW.m(null,$CLJS.AU,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null),c=$CLJS.I(a,2,null);a=$CLJS.I(a,3,null);return $CLJS.n(a)?$CLJS.de.g(FW.h(new $CLJS.Q(null,3,5,$CLJS.R,[$CLJS.AU,b,c],null)),a):new $CLJS.Q(null,3,5,$CLJS.R,[$CLJS.AU,eW.g?eW.g(b,fW):eW.call(null,b,fW),UV(c)],null)});
FW.m(null,$CLJS.lF,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);var c=eW.g?eW.g(a,fW):eW.call(null,a,fW);return new $CLJS.Q(null,3,5,$CLJS.R,[$CLJS.lF,b,function(){var d=$CLJS.n($CLJS.nA.h(c))?$CLJS.kk.j(c,$CLJS.nA,$CLJS.Bh):c;d=$CLJS.n($CLJS.rF.h(c))?$CLJS.kk.j(d,$CLJS.rF,$CLJS.Bh):d;return $CLJS.n($CLJS.rQ.h(c))?$CLJS.kk.j(d,$CLJS.rQ,function(e){return $CLJS.n($CLJS.ED.h(e))?$CLJS.kk.j(e,$CLJS.ED,$CLJS.Bh):e}):d}()],null)});
FW.m(null,DW,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);return new $CLJS.Q(null,3,5,$CLJS.R,[DW,b instanceof $CLJS.M?ZV(b):b,$CLJS.Bh.h(a)],null)});FW.m(null,CW,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null),c=$CLJS.I(a,2,null);a=$CLJS.I(a,3,null);return $CLJS.n(a)?new $CLJS.Q(null,4,5,$CLJS.R,[CW,eW.g?eW.g(b,fW):eW.call(null,b,fW),$CLJS.Wr,UV(a)],null):new $CLJS.Q(null,3,5,$CLJS.R,[CW,eW.g?eW.g(b,fW):eW.call(null,b,fW),UV(c)],null)});
FW.m(null,$CLJS.ZA,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null),c=$CLJS.I(a,2,null),d=$CLJS.I(a,3,null);a=$CLJS.I(a,4,null);return $CLJS.n(a)?$CLJS.de.g(FW.h(new $CLJS.Q(null,4,5,$CLJS.R,[$CLJS.ZA,b,c,d],null)),eW.g?eW.g(a,fW):eW.call(null,a,fW)):new $CLJS.Q(null,4,5,$CLJS.R,[$CLJS.ZA,eW.g?eW.g(b,fW):eW.call(null,b,fW),$CLJS.Gd(c)?c:UV(c),UV(d)],null)});
FW.m(null,$CLJS.VA,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);return $CLJS.n(a)?new $CLJS.Q(null,3,5,$CLJS.R,[$CLJS.VA,b,UV(a)],null):new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.VA,$CLJS.Ou],null)});FW.m(null,$CLJS.UA,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);return new $CLJS.Q(null,3,5,$CLJS.R,[$CLJS.UA,b,UV(a)],null)});
FW.m(null,$CLJS.XA,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null),c=$CLJS.I(a,2,null);a=$CLJS.I(a,3,null);return new $CLJS.Q(null,4,5,$CLJS.R,[$CLJS.XA,eW.g?eW.g(b,fW):eW.call(null,b,fW),c,UV(a)],null)});FW.m(null,$CLJS.$A,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null),c=$CLJS.I(a,2,null);a=$CLJS.I(a,3,null);return new $CLJS.Q(null,4,5,$CLJS.R,[$CLJS.$A,eW.g?eW.g(b,fW):eW.call(null,b,fW),c,UV(a)],null)});
FW.m(null,$CLJS.WA,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);return $CLJS.n(a)?new $CLJS.Q(null,3,5,$CLJS.R,[$CLJS.WA,eW.g?eW.g(b,fW):eW.call(null,b,fW),UV(a)],null):new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.WA,eW.g?eW.g(b,fW):eW.call(null,b,fW)],null)});
FW.m(null,$CLJS.YA,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null),c=$CLJS.I(a,2,null);a=$CLJS.I(a,3,null);return $CLJS.n(a)?new $CLJS.Q(null,4,5,$CLJS.R,[$CLJS.YA,eW.g?eW.g(b,fW):eW.call(null,b,fW),UV(c),UV(a)],null):new $CLJS.Q(null,3,5,$CLJS.R,[$CLJS.YA,eW.g?eW.g(b,fW):eW.call(null,b,fW),UV(c)],null)});
FW.m(null,$CLJS.TA,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null),c=$CLJS.I(a,2,null);a=$CLJS.I(a,3,null);return new $CLJS.Q(null,4,5,$CLJS.R,[$CLJS.TA,eW.g?eW.g(b,fW):eW.call(null,b,fW),eW.g?eW.g(c,fW):eW.call(null,c,fW),UV(a)],null)});FW.m(null,$CLJS.nj,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);return new $CLJS.Q(null,3,5,$CLJS.R,[$CLJS.nj,b,a],null)});
FW.m(null,$CLJS.ei,function(a){var b=$CLJS.y(a);a=$CLJS.z(b);b=$CLJS.B(b);return $CLJS.gg.j(new $CLJS.Q(null,1,5,$CLJS.R,[UV(a)],null),$CLJS.kf.h(function(c){return eW.g?eW.g(c,fW):eW.call(null,c,fW)}),b)});
var GW=function GW(a){if($CLJS.n($CLJS.uz($CLJS.ie,$CLJS.$a)(a))){var c=UV(a);var d=new $CLJS.ch(null,new $CLJS.h(null,18,[$CLJS.ln,null,$CLJS.Lq,null,$CLJS.zF,null,$CLJS.uF,null,$CLJS.Yr,null,$CLJS.mF,null,$CLJS.EF,null,$CLJS.FF,null,$CLJS.QE,null,$CLJS.XE,null,$CLJS.Kq,null,$CLJS.RE,null,$CLJS.yF,null,$CLJS.sF,null,$CLJS.Hj,null,$CLJS.Mw,null,$CLJS.fF,null,$CLJS.xF,null],null),null);c=d.h?d.h(c):d.call(null,c)}else c=null;return $CLJS.n(c)?c:$CLJS.n(cW(a))?(a=$CLJS.z(a),GW.h?GW.h(a):GW.call(null,
a)):null},fna=new $CLJS.h(null,8,[$CLJS.aj,UV,$CLJS.gP,function(a){a=VV(a);return $CLJS.y($CLJS.DP.h(a))?$CLJS.kk.j(a,$CLJS.DP,Ima):a},$CLJS.HE,new $CLJS.h(null,6,[$CLJS.aF,function HW(a){if($CLJS.n($CLJS.uz($CLJS.ie,$CLJS.$a)(a)))return UV(a);if($CLJS.n(dW(zW,a))){a=$CLJS.y(a);$CLJS.z(a);var c=$CLJS.B(a);a=$CLJS.z(c);c=$CLJS.B(c);return $CLJS.gg.g(new $CLJS.Q(null,2,5,$CLJS.R,[zW,HW.h?HW.h(a):HW.call(null,a)],null),c)}return $CLJS.n($CLJS.n(cW(a))?GW($CLJS.id(a)):null)?$CLJS.jk.g(HW,a):eW.g?eW.g(a,
fW):eW.call(null,a,fW)},$CLJS.XO,function(a){return $CLJS.gg.g($CLJS.N,function(){return function d(c){return new $CLJS.pe(null,function(){for(;;){var e=$CLJS.y(c);if(e){if($CLJS.Bd(e)){var f=$CLJS.mc(e),k=$CLJS.D(f),l=$CLJS.se(k);a:for(var m=0;;)if(m<k){var t=$CLJS.ld(f,m),u=$CLJS.I(t,0,null);t=$CLJS.I(t,1,null);u=new $CLJS.Q(null,2,5,$CLJS.R,[ZV(u),eW.g?eW.g(t,fW):eW.call(null,t,fW)],null);l.add(u);m+=1}else{f=!0;break a}return f?$CLJS.ve($CLJS.xe(l),d($CLJS.nc(e))):$CLJS.ve($CLJS.xe(l),null)}f=
$CLJS.z(e);l=$CLJS.I(f,0,null);f=$CLJS.I(f,1,null);return $CLJS.ge(new $CLJS.Q(null,2,5,$CLJS.R,[ZV(l),eW.g?eW.g(f,fW):eW.call(null,f,fW)],null),d($CLJS.Mc(e)))}return null}},null,null)}(a)}())},$CLJS.LQ,function(a){return $CLJS.Ff(function(){return function d(c){return new $CLJS.pe(null,function(){for(;;){var e=$CLJS.y(c);if(e){if($CLJS.Bd(e)){var f=$CLJS.mc(e),k=$CLJS.D(f),l=$CLJS.se(k);a:for(var m=0;;)if(m<k){var t=$CLJS.ld(f,m);t=$CLJS.n(cW(t))?FW.h(t):$CLJS.ee(FW.h($CLJS.ee(t)));l.add(t);m+=
1}else{f=!0;break a}return f?$CLJS.ve($CLJS.xe(l),d($CLJS.nc(e))):$CLJS.ve($CLJS.xe(l),null)}l=$CLJS.z(e);return $CLJS.ge($CLJS.n(cW(l))?FW.h(l):$CLJS.ee(FW.h($CLJS.ee(l))),d($CLJS.Mc(e)))}return null}},null,null)}(a)}())},$CLJS.FP,function(a){a=VV(a);a=$CLJS.O(a);var b=$CLJS.J.g(a,$CLJS.gP);if($CLJS.n(b))return a=$CLJS.xU(a,new $CLJS.h(null,1,[$CLJS.gP,$CLJS.HE],null)),b=new $CLJS.Q(null,1,5,$CLJS.R,[$CLJS.gP],null),a=eW.g?eW.g(a,b):eW.call(null,a,b),$CLJS.xU(a,new $CLJS.h(null,1,[$CLJS.HE,$CLJS.gP],
null));b=new $CLJS.Q(null,1,5,$CLJS.R,[$CLJS.HE],null);return eW.g?eW.g(a,b):eW.call(null,a,b)},$CLJS.PN,new $CLJS.h(null,1,[xW,gW],null),$CLJS.BM,new $CLJS.h(null,1,[xW,function(a){a=eW.g?eW.g(a,$CLJS.HE):eW.call(null,a,$CLJS.HE);var b=$CLJS.O(a),c=$CLJS.J.g(b,$CLJS.ED),d=$CLJS.J.g(b,$CLJS.TD);a=$CLJS.J.g(b,$CLJS.XD);b=$CLJS.n(c)?$CLJS.kk.j(b,$CLJS.ED,UV):b;d=$CLJS.n($CLJS.uz($CLJS.ie,$CLJS.$a)(d))?$CLJS.kk.j(b,$CLJS.TD,UV):b;return $CLJS.n(a)?$CLJS.kk.j(d,$CLJS.XD,ZV):d}],null)],null),$CLJS.Bx,
new $CLJS.h(null,1,[$CLJS.mN,$CLJS.Ud],null),$CLJS.sM,new $CLJS.h(null,1,[xW,function(a){var b=$CLJS.O(a),c=$CLJS.J.g(b,$CLJS.aj),d=$CLJS.J.g(b,$CLJS.mI),e=$CLJS.J.g(b,$CLJS.Si);a=$CLJS.J.g(b,AW);b=$CLJS.n(e)?$CLJS.kk.j(b,$CLJS.Si,ZV):b;c=$CLJS.n(c)?$CLJS.kk.j(b,$CLJS.aj,UV):b;d=$CLJS.n(d)?$CLJS.kk.j(c,$CLJS.mI,function(f){return eW.g?eW.g(f,fW):eW.call(null,f,fW)}):c;d=$CLJS.n(a)?$CLJS.vW.j(d,new $CLJS.Q(null,2,5,$CLJS.R,[AW,Yma],null),function(f){return eW.g?eW.g(f,fW):eW.call(null,f,fW)}):d;return $CLJS.n(a)?
$CLJS.vW.j(d,new $CLJS.Q(null,2,5,$CLJS.R,[AW,Uma],null),function(f){return eW.g?eW.g(f,fW):eW.call(null,f,fW)}):d}],null),$CLJS.nM,function(a){return null==a?null:UV(a)},$CLJS.PN,new $CLJS.h(null,1,[xW,gW],null),EW,UV],null),eW=function eW(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return eW.l(arguments[0],1<c.length?new $CLJS.w(c.slice(1),0,null):null)};
eW.l=function(a,b){b=$CLJS.I(b,0,null);var c=b instanceof $CLJS.M?new $CLJS.Q(null,1,5,$CLJS.R,[b],null):$CLJS.Ff(b);b=$CLJS.y(c)?$CLJS.wz(fna,c):null;try{return $CLJS.nd(b)?b.h?b.h(a):b.call(null,a):$CLJS.zd(a)?a:$CLJS.yd(a)?$CLJS.gg.g($CLJS.N,function(){return function k(f){return new $CLJS.pe(null,function(){for(;;){var l=$CLJS.y(f);if(l){if($CLJS.Bd(l)){var m=$CLJS.mc(l),t=$CLJS.D(m),u=$CLJS.se(t);a:for(var v=0;;)if(v<t){var x=$CLJS.ld(m,v),A=$CLJS.I(x,0,null);x=$CLJS.I(x,1,null);A=UV(A);A=new $CLJS.Q(null,
2,5,$CLJS.R,[A,eW.l(x,$CLJS.H([$CLJS.de.g($CLJS.Ff(c),A)]))],null);u.add(A);v+=1}else{m=!0;break a}return m?$CLJS.ve($CLJS.xe(u),k($CLJS.nc(l))):$CLJS.ve($CLJS.xe(u),null)}m=$CLJS.z(l);u=$CLJS.I(m,0,null);m=$CLJS.I(m,1,null);u=UV(u);return $CLJS.ge(new $CLJS.Q(null,2,5,$CLJS.R,[u,eW.l(m,$CLJS.H([$CLJS.de.g($CLJS.Ff(c),u)]))],null),k($CLJS.Mc(l)))}return null}},null,null)}(a)}()):$CLJS.n(cW(a))?FW.h(a):$CLJS.xd(a)?$CLJS.jk.g(function(e){return eW.l(e,$CLJS.H([$CLJS.de.g($CLJS.Ff(c),xW)]))},a):a}catch(e){if(e instanceof
Error){var d=e;throw $CLJS.ii($CLJS.iD("Error normalizing form: {0}",$CLJS.H([$CLJS.qU(d)])),new $CLJS.h(null,3,[$CLJS.Ty,a,$CLJS.Tk,c,Xma,b],null),d);}throw e;}};eW.A=1;eW.B=function(a){var b=$CLJS.z(a);a=$CLJS.B(a);return this.l(b,a)};
var iW=function(){var a=$CLJS.Ze($CLJS.N),b=$CLJS.Ze($CLJS.N),c=$CLJS.Ze($CLJS.N),d=$CLJS.Ze($CLJS.N),e=$CLJS.J.j($CLJS.N,$CLJS.Jk,$CLJS.Xh.o?$CLJS.Xh.o():$CLJS.Xh.call(null));return new $CLJS.fi($CLJS.Hh.g("metabase.mbql.normalize","canonicalize-mbql-clause"),function(f){return $CLJS.n(cW(f))?$CLJS.z(f):null},e,a,b,c,d)}();iW.m(null,$CLJS.ei,function(a){return a});
iW.m(null,$CLJS.lF,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);if($CLJS.n(dW($CLJS.lF,b))){$CLJS.I(b,0,null);var c=$CLJS.I(b,1,null);b=$CLJS.I(b,2,null);return iW.h(new $CLJS.Q(null,3,5,$CLJS.R,[$CLJS.lF,c,$CLJS.Ie($CLJS.zk.l($CLJS.H([b,a])))],null))}return new $CLJS.Q(null,3,5,$CLJS.R,[$CLJS.lF,b,$CLJS.Ie(a)],null)});
iW.m(null,$CLJS.aF,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);return $CLJS.ud(a)?new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.aF,b],null):new $CLJS.Q(null,3,5,$CLJS.R,[$CLJS.aF,b,a],null)});iW.m(null,$CLJS.RJ,function(a){$CLJS.I(a,0,null);a=$CLJS.I(a,1,null);return $CLJS.n(cW(a))?iW.h(a):new $CLJS.Q(null,3,5,$CLJS.R,[$CLJS.lF,a,null],null)});
iW.m(null,DW,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);return new $CLJS.Q(null,3,5,$CLJS.R,[$CLJS.lF,b,new $CLJS.h(null,1,[$CLJS.nA,a],null)],null)});iW.m(null,Zma,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);var c=jW(b);$CLJS.I(c,0,null);b=$CLJS.I(c,1,null);$CLJS.I(c,2,null);c=jW(a);$CLJS.I(c,0,null);a=$CLJS.I(c,1,null);c=$CLJS.I(c,2,null);return new $CLJS.Q(null,3,5,$CLJS.R,[$CLJS.lF,a,$CLJS.T.j(c,$CLJS.CM,b)],null)});
iW.m(null,$ma,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);a=jW(a);return $CLJS.P.v($CLJS.FU,a,$CLJS.T,$CLJS.H([$CLJS.rO,b]))});
iW.m(null,CW,function(a){var b=$CLJS.D(a);switch(b){case 3:$CLJS.I(a,0,null);b=$CLJS.I(a,1,null);var c=$CLJS.I(a,2,null);a=jW(b);b=c;$CLJS.I(a,0,null);$CLJS.I(a,1,null);c=$CLJS.I(a,2,null);c=$CLJS.O(c);var d=$CLJS.J.g(c,$CLJS.nA);$CLJS.Wa(d)||$CLJS.IR.g(d,b)?a=$CLJS.P.v($CLJS.FU,a,$CLJS.T,$CLJS.H([$CLJS.rF,b])):(c=$CLJS.Gz($CLJS.zx),$CLJS.n($CLJS.Fz("metabase.mbql.util",c))&&(b=$CLJS.iD("{0} is not a valid temporal unit for {1}; not adding to clause {2}",$CLJS.H([b,d,$CLJS.Oh.l($CLJS.H([a]))])),b instanceof
Error?$CLJS.Ez("metabase.mbql.util",c,$CLJS.vv(),b):$CLJS.Ez("metabase.mbql.util",c,$CLJS.vv.l($CLJS.H([b])),null)));return a;case 4:return $CLJS.I(a,0,null),b=$CLJS.I(a,1,null),$CLJS.I(a,2,null),c=$CLJS.I(a,3,null),iW.h(new $CLJS.Q(null,3,5,$CLJS.R,[CW,b,c],null));default:throw Error(["No matching clause: ",$CLJS.p.h(b)].join(""));}});
iW.m(null,$CLJS.AU,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null),c=$CLJS.I(a,2,null),d=$CLJS.I(a,3,null);a=$CLJS.I(a,4,null);var e=jW(b);$CLJS.I(e,0,null);b=$CLJS.I(e,1,null);e=$CLJS.I(e,2,null);return new $CLJS.Q(null,3,5,$CLJS.R,[$CLJS.lF,b,$CLJS.T.j(e,$CLJS.rQ,$CLJS.zk.l($CLJS.H([new $CLJS.h(null,1,[$CLJS.ED,c],null),$CLJS.n(d)?$CLJS.He([c,d]):null,a])))],null)});
for(var IW=$CLJS.y(new $CLJS.Q(null,3,5,$CLJS.R,[$CLJS.mr,$CLJS.fr,$CLJS.hr],null)),JW=null,KW=0,LW=0;;)if(LW<KW){var MW=JW.X(null,LW);iW.m(null,MW,function(){return function(a){return kW(a)}}(IW,JW,KW,LW,MW));LW+=1}else{var NW=$CLJS.y(IW);if(NW){var OW=NW;if($CLJS.Bd(OW)){var PW=$CLJS.mc(OW),gna=$CLJS.nc(OW),hna=PW,ina=$CLJS.D(PW);IW=gna;JW=hna;KW=ina}else{var QW=$CLJS.z(OW);iW.m(null,QW,function(){return function(a){return kW(a)}}(IW,JW,KW,LW,QW,OW,NW));IW=$CLJS.B(OW);JW=null;KW=0}LW=0}else break}
iW.m(null,$CLJS.TE,function(a){a=$CLJS.y(a);$CLJS.z(a);var b=$CLJS.B(a);a=$CLJS.z(b);var c=$CLJS.B(b);b=$CLJS.z(c);c=$CLJS.B(c);return $CLJS.gg.g(new $CLJS.Q(null,3,5,$CLJS.R,[$CLJS.TE,jW(a),jW(b)],null),c)});iW.m(null,$CLJS.ZA,function(a){a=$CLJS.y(a);$CLJS.z(a);var b=$CLJS.B(a);a=$CLJS.z(b);b=$CLJS.B(b);var c=jW(a);a=$CLJS.n($V($CLJS.lF,a))?$CLJS.FU.l(c,$CLJS.ak,$CLJS.H([$CLJS.rF])):c;return $CLJS.gg.g(new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.ZA,a],null),b)});
for(var RW=$CLJS.y(new $CLJS.Q(null,15,5,$CLJS.R,[$CLJS.cF,$CLJS.wF,$CLJS.kF,$CLJS.dF,$CLJS.Nj,$CLJS.BF,$CLJS.Gq,$CLJS.Iq,$CLJS.Cq,$CLJS.Eq,$CLJS.OE,$CLJS.VE,$CLJS.ME,$CLJS.YE,$CLJS.NE],null)),SW=null,TW=0,UW=0;;)if(UW<TW){var VW=SW.X(null,UW);iW.m(null,VW,function(){return function(a){return lW(a)}}(RW,SW,TW,UW,VW));UW+=1}else{var WW=$CLJS.y(RW);if(WW){var XW=WW;if($CLJS.Bd(XW)){var YW=$CLJS.mc(XW),jna=$CLJS.nc(XW),kna=YW,lna=$CLJS.D(YW);RW=jna;SW=kna;TW=lna}else{var ZW=$CLJS.z(XW);iW.m(null,ZW,
function(){return function(a){return lW(a)}}(RW,SW,TW,UW,ZW,XW,WW));RW=$CLJS.B(XW);SW=null;TW=0}UW=0}else break}iW.m(null,Wma,function(){return null});iW.m(null,$CLJS.sL,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);return new $CLJS.Q(null,3,5,$CLJS.R,[$CLJS.sL,iW.h(b),a],null)});
iW.m(null,zW,function(a){a=$CLJS.y(a);$CLJS.z(a);a=$CLJS.B(a);var b=$CLJS.z(a),c=$CLJS.B(a);a=$CLJS.z(c);var d=$CLJS.B(c);c=iW.h;var e=$CLJS.R;b=iW.h(b);d=$CLJS.I(d,0,null);d=$CLJS.O(d);a=!1===$CLJS.J.g(d,Vma)?new $CLJS.h(null,1,[$CLJS.U,a],null):new $CLJS.h(null,1,[$CLJS.nD,a],null);return c.call(iW,new $CLJS.Q(null,3,5,e,[$CLJS.sL,b,a],null))});
for(var $W=$CLJS.y(new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.Mw,$CLJS.mF],null)),aX=null,bX=0,cX=0;;)if(cX<bX){var dX=aX.X(null,cX);iW.m(null,dX,function(){return function(a){return mW(a)}}($W,aX,bX,cX,dX));cX+=1}else{var eX=$CLJS.y($W);if(eX){var fX=eX;if($CLJS.Bd(fX)){var gX=$CLJS.mc(fX),mna=$CLJS.nc(fX),nna=gX,ona=$CLJS.D(gX);$W=mna;aX=nna;bX=ona}else{var hX=$CLJS.z(fX);iW.m(null,hX,function(){return function(a){return mW(a)}}($W,aX,bX,cX,hX,fX,eX));$W=$CLJS.B(fX);aX=null;bX=0}cX=0}else break}
for(var iX=$CLJS.y(new $CLJS.Q(null,9,5,$CLJS.R,[$CLJS.fF,$CLJS.GF,$CLJS.QE,$CLJS.zF,$CLJS.xF,$CLJS.ln,$CLJS.Hj,$CLJS.yF,$CLJS.RE],null)),jX=null,kX=0,lX=0;;)if(lX<kX){var mX=jX.X(null,lX);iW.m(null,mX,function(){return function(a){return nW(a)}}(iX,jX,kX,lX,mX));lX+=1}else{var nX=$CLJS.y(iX);if(nX){var oX=nX;if($CLJS.Bd(oX)){var pX=$CLJS.mc(oX),pna=$CLJS.nc(oX),qna=pX,rna=$CLJS.D(pX);iX=pna;jX=qna;kX=rna}else{var qX=$CLJS.z(oX);iW.m(null,qX,function(){return function(a){return nW(a)}}(iX,jX,kX,lX,
qX,oX,nX));iX=$CLJS.B(oX);jX=null;kX=0}lX=0}else break}iW.m(null,$CLJS.XE,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);return new $CLJS.Q(null,3,5,$CLJS.R,[$CLJS.XE,jW(b),a],null)});
for(var rX=$CLJS.y(new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.sF,$CLJS.uF],null)),sX=null,tX=0,uX=0;;)if(uX<tX){var vX=sX.X(null,uX);iW.m(null,vX,function(){return function(a){return oW(a)}}(rX,sX,tX,uX,vX));uX+=1}else{var wX=$CLJS.y(rX);if(wX){var xX=wX;if($CLJS.Bd(xX)){var yX=$CLJS.mc(xX),sna=$CLJS.nc(xX),tna=yX,una=$CLJS.D(yX);rX=sna;sX=tna;tX=una}else{var zX=$CLJS.z(xX);iW.m(null,zX,function(){return function(a){return oW(a)}}(rX,sX,tX,uX,zX,xX,wX));rX=$CLJS.B(xX);sX=null;tX=0}uX=0}else break}
iW.m(null,$CLJS.EF,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);return new $CLJS.Q(null,3,5,$CLJS.R,[$CLJS.EF,iW.h(b),iW.h(a)],null)});
iW.m(null,$CLJS.UE,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);return $CLJS.n(a)?$CLJS.de.g(iW.h(new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.UE,b],null)),eW.l(a,$CLJS.H([fW]))):new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.UE,$CLJS.Ff(function(){return function e(d){return new $CLJS.pe(null,function(){for(;;){var f=$CLJS.y(d);if(f){if($CLJS.Bd(f)){var k=$CLJS.mc(f),l=$CLJS.D(k),m=$CLJS.se(l);a:for(var t=0;;)if(t<l){var u=$CLJS.ld(k,t),v=$CLJS.I(u,0,null);u=$CLJS.I(u,1,null);v=new $CLJS.Q(null,
2,5,$CLJS.R,[iW.h(v),iW.h(u)],null);m.add(v);t+=1}else{k=!0;break a}return k?$CLJS.ve($CLJS.xe(m),e($CLJS.nc(f))):$CLJS.ve($CLJS.xe(m),null)}k=$CLJS.z(f);m=$CLJS.I(k,0,null);k=$CLJS.I(k,1,null);return $CLJS.ge(new $CLJS.Q(null,2,5,$CLJS.R,[iW.h(m),iW.h(k)],null),e($CLJS.Mc(f)))}return null}},null,null)}(b)}())],null)});
iW.m(null,$CLJS.DE,function(a){a=$CLJS.y(a);$CLJS.z(a);var b=$CLJS.B(a);a=$CLJS.z(b);var c=$CLJS.B(b);b=$CLJS.z(c);c=$CLJS.B(c);return $CLJS.gg.g(new $CLJS.Q(null,3,5,$CLJS.R,[$CLJS.DE,iW.h(a),$CLJS.E.g(0,b)?1:iW.h(b)],null),$CLJS.kf.g(iW,c))});
var qW=function qW(a){return function f(d,e){try{if($CLJS.n(function(){var x=XV($CLJS.Ed);return x.h?x.h(e):x.call(null,e)}()))return f(d,$CLJS.Ff(e));throw $CLJS.Z;}catch(x){if(x instanceof Error)if(d=x,d===$CLJS.Z)try{if($CLJS.n(function(){var A=XV($CLJS.ie);return A.h?A.h(e):A.call(null,e)}()))return new $CLJS.Q(null,1,5,$CLJS.R,[new $CLJS.Q(null,1,5,$CLJS.R,[e],null)],null);throw $CLJS.Z;}catch(A){if(A instanceof Error)if(d=A,d===$CLJS.Z)try{if($CLJS.Ad(e)&&2<=$CLJS.D(e))try{var k=$CLJS.ok.j(e,
0,2);if($CLJS.Ad(k)&&2===$CLJS.D(k))try{var l=$CLJS.F(k,0);if($CLJS.n($CLJS.gD($CLJS.ie,$CLJS.Ve(new $CLJS.ch(null,new $CLJS.h(null,5,[$CLJS.Lq,null,$CLJS.Yr,null,$CLJS.FF,null,$CLJS.Kq,null,zW,null],null),null)))(l)))try{var m=$CLJS.F(k,1);if($CLJS.n(GW(m)))return $CLJS.gg.j($CLJS.Ef,$CLJS.hD(qW),a);throw $CLJS.Z;}catch(C){if(C instanceof Error){var t=C;if(t===$CLJS.Z)throw $CLJS.Z;throw t;}throw C;}else throw $CLJS.Z;}catch(C){if(C instanceof Error){t=C;if(t===$CLJS.Z)throw $CLJS.Z;throw t;}throw C;
}else throw $CLJS.Z;}catch(C){if(C instanceof Error){t=C;if(t===$CLJS.Z)throw $CLJS.Z;throw t;}throw C;}else throw $CLJS.Z;}catch(C){if(C instanceof Error)if(t=C,t===$CLJS.Z)try{if($CLJS.Ad(e)&&1<=$CLJS.D(e))try{var u=$CLJS.ok.j(e,0,1);if($CLJS.Ad(u)&&1===$CLJS.D(u))try{if($CLJS.F(u,0)instanceof $CLJS.M)return new $CLJS.Q(null,1,5,$CLJS.R,[e],null);throw $CLJS.Z;}catch(G){if(G instanceof Error){var v=G;if(v===$CLJS.Z)throw $CLJS.Z;throw v;}throw G;}else throw $CLJS.Z;}catch(G){if(G instanceof Error){v=
G;if(v===$CLJS.Z)throw $CLJS.Z;throw v;}throw G;}else throw $CLJS.Z;}catch(G){if(G instanceof Error){v=G;if(v===$CLJS.Z)return e;throw v;}throw G;}else throw t;else throw C;}else throw d;else throw A;}else throw d;else throw x;}}($CLJS.Ef,a)},AX=function AX(a){return function f(d,e){try{var k=XV($CLJS.Ed);var l=k.h?k.h(e):k.call(null,e);if($CLJS.n(l))return f(d,$CLJS.Ff(e));throw $CLJS.Z;}catch(C){if(C instanceof Error)if(l=C,l===$CLJS.Z)try{if($CLJS.Ad(e)&&2===$CLJS.D(e))try{var m=$CLJS.F(e,1);if($CLJS.je(m,
$CLJS.iF)){var t=$CLJS.F(e,0);return f(d,new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.iF,t],null))}throw $CLJS.Z;}catch(G){if(G instanceof Error)if(l=G,l===$CLJS.Z)try{m=$CLJS.F(e,1);if($CLJS.je(m,$CLJS.bF))return t=$CLJS.F(e,0),f(d,new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.bF,t],null));throw $CLJS.Z;}catch(K){if(K instanceof Error){var u=K;if(u===$CLJS.Z)try{m=$CLJS.F(e,1);if($CLJS.je(m,yW))return t=$CLJS.F(e,0),f(d,new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.iF,t],null));throw $CLJS.Z;}catch(S){if(S instanceof Error)if(l=
S,l===$CLJS.Z)try{m=$CLJS.F(e,1);if($CLJS.je(m,BW))return t=$CLJS.F(e,0),f(d,new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.bF,t],null));throw $CLJS.Z;}catch(X){if(X instanceof Error)if(m=X,m===$CLJS.Z)try{var v=$CLJS.F(e,0);if($CLJS.je(v,yW))return t=$CLJS.F(e,1),f(d,new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.iF,t],null));throw $CLJS.Z;}catch(ba){if(ba instanceof Error)if(m=ba,m===$CLJS.Z)try{v=$CLJS.F(e,0);if($CLJS.je(v,BW))return t=$CLJS.F(e,1),f(d,new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.bF,t],null));throw $CLJS.Z;
}catch(ha){if(ha instanceof Error)if(m=ha,m===$CLJS.Z)try{v=$CLJS.F(e,0);if($CLJS.je(v,$CLJS.iF))return t=$CLJS.F(e,1),new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.iF,jW(t)],null);throw $CLJS.Z;}catch(ua){if(ua instanceof Error)if(m=ua,m===$CLJS.Z)try{v=$CLJS.F(e,0);if($CLJS.je(v,$CLJS.bF))return t=$CLJS.F(e,1),new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.bF,jW(t)],null);throw $CLJS.Z;}catch(Ua){if(Ua instanceof Error){t=Ua;if(t===$CLJS.Z)throw $CLJS.Z;throw t;}throw Ua;}else throw m;else throw ua;}else throw m;else throw ha;
}else throw m;else throw ba;}else throw m;else throw X;}else throw l;else throw S;}else throw u;}else throw K;}else throw l;else throw G;}else throw $CLJS.Z;}catch(G){if(G instanceof Error)if(l=G,l===$CLJS.Z)try{if($CLJS.Ad(e)&&0<=$CLJS.D(e))try{var x=$CLJS.ok.j(e,0,0);if($CLJS.Ad(x)&&0===$CLJS.D(x))try{var A=$CLJS.ok.g(e,0);if($CLJS.E.g(A,a))return $CLJS.Ff($CLJS.Ak.h($CLJS.kf.g(AX,a)));throw $CLJS.Z;}catch(K){if(K instanceof Error){u=K;if(u===$CLJS.Z)throw $CLJS.Z;throw u;}throw K;}else throw $CLJS.Z;
}catch(K){if(K instanceof Error){u=K;if(u===$CLJS.Z)throw $CLJS.Z;throw u;}throw K;}else throw $CLJS.Z;}catch(K){if(K instanceof Error){u=K;if(u===$CLJS.Z)return $CLJS.YV(f,d,e);throw u;}throw K;}else throw l;else throw G;}else throw l;else throw C;}}($CLJS.Ef,a)},tW=$CLJS.hk.g(WV,function(a){var b=uW($CLJS.aF.h(a))?$CLJS.kk.j(a,$CLJS.aF,Lma):a;b=uW($CLJS.$E.h(a))?$CLJS.kk.j(b,$CLJS.$E,Mma):b;b=uW($CLJS.TD.h(a))?$CLJS.kk.j(b,$CLJS.TD,$CLJS.Xe($CLJS.jk,hW)):b;b=uW($CLJS.LQ.h(a))?$CLJS.kk.j(b,$CLJS.LQ,
AX):b;return uW($CLJS.FP.h(a))?$CLJS.kk.j(b,$CLJS.FP,Oma):b}),vna=new $CLJS.h(null,3,[$CLJS.gP,$CLJS.Ud,$CLJS.HE,new $CLJS.h(null,2,[$CLJS.FP,function(a){a=$CLJS.O(a);var b=$CLJS.J.g(a,$CLJS.gP);if($CLJS.n(b))return a=$CLJS.xU(a,new $CLJS.h(null,1,[$CLJS.gP,$CLJS.HE],null)),b=new $CLJS.Q(null,1,5,$CLJS.R,[$CLJS.gP],null),a=wW.g?wW.g(a,b):wW.call(null,a,b),$CLJS.xU(a,new $CLJS.h(null,1,[$CLJS.HE,$CLJS.gP],null));b=new $CLJS.Q(null,1,5,$CLJS.R,[$CLJS.HE],null);return wW.g?wW.g(a,b):wW.call(null,a,b)},
$CLJS.BM,new $CLJS.h(null,1,[xW,function(a){var b=new $CLJS.Q(null,1,5,$CLJS.R,[$CLJS.HE],null);return wW.g?wW.g(a,b):wW.call(null,a,b)}],null)],null),EW,$CLJS.Ud],null),wW=function wW(a){switch(arguments.length){case 1:return wW.h(arguments[0]);case 2:return wW.g(arguments[0],arguments[1]);default:throw Error(["Invalid arity: ",$CLJS.p.h(arguments.length)].join(""));}};wW.h=function(a){return wW.g(a,$CLJS.Ef)};
wW.g=function(a,b){try{var c=$CLJS.y(b)?$CLJS.wz(vna,b):null;return $CLJS.nd(c)?c.h?c.h(a):c.call(null,a):$CLJS.zd(a)?a:$CLJS.yd(a)?Sma(a,b):$CLJS.xd(a)?Tma(a,b):a}catch(d){if(d instanceof Error)throw $CLJS.ii("Error removing empty clauses from form.",new $CLJS.h(null,2,[$CLJS.Ty,a,$CLJS.Tk,b],null),d);throw d;}};wW.A=2;
$CLJS.BX=function(){var a=$CLJS.hk.l(wW,Rma,Pma,$CLJS.H([eW]));return function(b){try{return a(b)}catch(d){if(d instanceof Error){var c=d;throw $CLJS.ii($CLJS.iD("Error normalizing query: {0}",$CLJS.H([$CLJS.qU(c)])),new $CLJS.h(null,1,[$CLJS.HE,b],null),c);}throw d;}}}();$CLJS.CX=function CX(a,b){if($CLJS.Wa($CLJS.y(a)))a=(0,$CLJS.BX)(b);else{var d=$CLJS.J,e=d.g;var f=$CLJS.ds(a);b=$CLJS.He([$CLJS.jd(a),b]);f=CX.g?CX.g(f,b):CX.call(null,f,b);a=e.call(d,f,$CLJS.jd(a))}return a};