var window=global;var $CLJS=require("./cljs_env.js");require("./cljs.core.js");require("./shadow.js.shim.module$moment.js");require("./clojure.string.js");require("./metabase.mbql.normalize.js");require("./metabase.shared.util.i18n.js");
'use strict';var V$=function(a){return new $CLJS.pe(null,function(){return $CLJS.ge(a.o?a.o():a.call(null),V$(a))},null,null)},W$=function(a,b){return new $CLJS.pe(null,function(){var c=$CLJS.y(b);if(c){var d=$CLJS.z(c),e=a.h?a.h(d):a.call(null,d),f=$CLJS.ge(d,$CLJS.pt(function(k){return $CLJS.E.g(e,a.h?a.h(k):a.call(null,k))},$CLJS.B(c)));return $CLJS.ge(f,W$(a,new $CLJS.pe(null,function(){return $CLJS.df($CLJS.D(f),c)},null,null)))}return null},null,null)},Eya=function(a,b){switch(a){case "minutes":return $CLJS.wU("Minute",
"Minutes",b);case "hours":return $CLJS.wU("Hour","Hours",b);case "days":return $CLJS.wU("Day","Days",b);case "weeks":return $CLJS.wU("Week","Weeks",b);case "months":return $CLJS.wU("Month","Months",b);case "quarters":return $CLJS.wU("Quarter","Quarters",b);case "years":return $CLJS.wU("Year","Years",b);default:throw Error(["No matching clause: ",$CLJS.p.h(a)].join(""));}},Fya=function(a,b,c){b=parseInt(b);c=Eya(c,b);a=new $CLJS.Q(null,2,5,$CLJS.R,[a,$CLJS.E.g(b,1)],null);if($CLJS.E.g(new $CLJS.Q(null,
2,5,$CLJS.R,["past",!0],null),a))return $CLJS.iD("Previous {0}",$CLJS.H([c]));if($CLJS.E.g(new $CLJS.Q(null,2,5,$CLJS.R,["past",!1],null),a))return $CLJS.iD("Previous {0} {1}",$CLJS.H([b,c]));if($CLJS.E.g(new $CLJS.Q(null,2,5,$CLJS.R,["next",!0],null),a))return $CLJS.iD("Next {0}",$CLJS.H([c]));if($CLJS.E.g(new $CLJS.Q(null,2,5,$CLJS.R,["next",!1],null),a))return $CLJS.iD("Next {0} {1}",$CLJS.H([b,c]));throw Error(["No matching clause: ",$CLJS.p.h(a)].join(""));},Hya=function(a){return $CLJS.Az(a,
Gya,function(b){return["\\",$CLJS.p.h(b)].join("")})},X$=function(a,b,c,d,e){this.tag=a;this.source=b;this.T=c;this.G=d;this.J=e;this.C=2230716170;this.I=139264},Jya=function(a){var b=$CLJS.Ms(a,Iya),c=$CLJS.kf.g($CLJS.z,$CLJS.SV(Y$,a)),d=function(){var e=$CLJS.D(b),f=$CLJS.D(c);return e>f?e:f}();a=$CLJS.jf.g(b,$CLJS.cf(d-$CLJS.D(b),V$($CLJS.We(""))));d=$CLJS.jf.g(c,$CLJS.cf(d-$CLJS.D(c),V$($CLJS.We(""))));a=$CLJS.gf.g(a,d);return $CLJS.kf.g(function(e){var f=$CLJS.ph(Y$,e);return $CLJS.n(f)?($CLJS.I(f,
0,null),f=$CLJS.I(f,1,null),new X$(f,e,null,null,null)):e},a)},Kya=function(a){return $CLJS.lf(function(b){return"string"===typeof $CLJS.z(b)?new $CLJS.Q(null,1,5,$CLJS.R,[$CLJS.uU(b)],null):b},$CLJS.H([W$(function(b){return"string"===typeof b||$CLJS.Wa($CLJS.nj.h(b))},a)]))},Lya=function(a,b,c,d){return $CLJS.kf.g(function(e){if(e instanceof X$){var f=$CLJS.T.j;var k=$CLJS.pj.h(e),l=$CLJS.J.g(a,k);k=$CLJS.nj.h(l);l=$CLJS.aj.h(l);if($CLJS.n(k))try{var m=Z$.j(l,k,b);var t=$CLJS.n(c)?Hya(m):m}catch(u){if(u instanceof
Error)t=Z$.j($CLJS.ei,k,b);else throw u;}else t=null;e=f.call($CLJS.T,e,$CLJS.nj,t)}return e},d)},Oya=function(a){a=$CLJS.uU($CLJS.kf.g(function(b){return b instanceof X$?b:$CLJS.Az(b,Mya,"")},a));return $CLJS.Az(a,Nya,$CLJS.id)},Pya=function(a){return $CLJS.yz($CLJS.z($CLJS.CX(new $CLJS.Q(null,1,5,$CLJS.R,[$CLJS.sM],null),new $CLJS.Q(null,1,5,$CLJS.R,[a],null))),$CLJS.Bh)};var Z$=function(){var a=$CLJS.Ze($CLJS.N),b=$CLJS.Ze($CLJS.N),c=$CLJS.Ze($CLJS.N),d=$CLJS.Ze($CLJS.N),e=$CLJS.J.j($CLJS.N,$CLJS.Jk,$CLJS.Xh.o?$CLJS.Xh.o():$CLJS.Xh.call(null));return new $CLJS.fi($CLJS.Hh.g("metabase.shared.parameters.parameters","formatted-value"),function(f){return $CLJS.Bh.h(f)},e,a,b,c,d)}();Z$.m(null,$CLJS.VN,function(a,b,c){return(0,$CLJS.MH)(b).locale(c).format("MMMM D, YYYY")});
Z$.m(null,$CLJS.xM,function(a,b,c){a=(0,$CLJS.MH)(b,"YYYY-MM").locale(c);return $CLJS.n(a.isValid())?a.format("MMMM, YYYY"):""});Z$.m(null,$CLJS.rN,function(a,b,c){a=(0,$CLJS.MH)(b,"[Q]Q-YYYY").locale(c);return $CLJS.n(a.isValid())?a.format("[Q]Q, YYYY"):""});Z$.m(null,$CLJS.aM,function(a,b,c){b=$CLJS.Ms(b,/~/);a=$CLJS.I(b,0,null);b=$CLJS.I(b,1,null);return $CLJS.n($CLJS.n(a)?b:a)?[$CLJS.p.h(Z$.j($CLJS.VN,a,c))," - ",$CLJS.p.h(Z$.j($CLJS.VN,b,c))].join(""):""});
Z$.m(null,$CLJS.sN,function(a,b){function c(d,e){return $CLJS.B($CLJS.qh(d,e))}if(c(/^today$/,b)||c(/^thisday$/,b))return $CLJS.LD("Today");if(c(/^thisweek$/,b))return $CLJS.LD("This Week");if(c(/^thismonth$/,b))return $CLJS.LD("This Month");if(c(/^thisquarter$/,b))return $CLJS.LD("This Quarter");if(c(/^thisyear$/,b))return $CLJS.LD("This Year");if(c(/^past1days$/,b))return $CLJS.LD("Yesterday");if(c(/^next1days$/,b))return $CLJS.LD("Tomorrow");if(a=c(/^(past|next)([0-9]+)([a-z]+)~?$/,b))return $CLJS.P.g(Fya,
a);throw Error(["No matching clause: ",$CLJS.p.h(b)].join(""));});Z$.m(null,$CLJS.YQ,function(a,b,c){function d(e,f){return $CLJS.id($CLJS.qh(e,f))}a=d(/^(this[a-z]+)$/,b);if($CLJS.n(a))return Z$.j($CLJS.sN,a,c);a=d(/^~?([0-9-T:]+)~?$/,b);if($CLJS.n(a))return Z$.j($CLJS.VN,a,c);a=d(/^([0-9-T:]+~[0-9-T:]+)$/,b);return $CLJS.n(a)?Z$.j($CLJS.aM,a,c):Z$.j($CLJS.sN,b,c)});
Z$.m(null,$CLJS.ei,function(a,b){$CLJS.xd(b)?(a=$CLJS.D(b),b=$CLJS.n($CLJS.E.g?$CLJS.E.g(1,a):$CLJS.E.call(null,1,a))?$CLJS.p.h($CLJS.z(b)):$CLJS.n($CLJS.E.g?$CLJS.E.g(2,a):$CLJS.E.call(null,2,a))?$CLJS.iD("{0} and {1}",$CLJS.H([$CLJS.z(b),$CLJS.id(b)])):$CLJS.iD("{0}, {1}, and {2}",$CLJS.H([$CLJS.gs(", ",$CLJS.qt(2,b)),$CLJS.F(b,$CLJS.D(b)-2),$CLJS.jd(b)]))):b=$CLJS.p.h(b);return b});var Gya=/[\\\/*_`'\[\](){}<>#+-.!$@%^&=|\?~]/,Y$=/\{\{\s*([A-Za-z0-9_\.]+?)\s*\}\}/,Iya=/\{\{\s*[A-Za-z0-9_\.]+?\s*\}\}/;
$CLJS.g=X$.prototype;$CLJS.g.toString=function(){var a=$CLJS.nj.h(this);return $CLJS.n(a)?a:this.source};$CLJS.g.na=function(a,b){return this.$(null,b,null)};$CLJS.g.$=function(a,b,c){switch(b instanceof $CLJS.M?b.S:null){case "tag":return this.tag;case "source":return this.source;default:return $CLJS.J.j(this.G,b,c)}};$CLJS.g.Fb=function(a,b,c){return $CLJS.fb(function(d,e){var f=$CLJS.I(e,0,null);e=$CLJS.I(e,1,null);return b.j?b.j(d,f,e):b.call(null,d,f,e)},c,this)};
$CLJS.g.da=function(a,b,c){return $CLJS.uh(b,function(d){return $CLJS.uh(b,$CLJS.Ah,""," ","",c,d)},"#metabase.shared.parameters.parameters.TextParam{",", ","}",c,$CLJS.jf.g(new $CLJS.Q(null,2,5,$CLJS.R,[new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.pj,this.tag],null),new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.Vy,this.source],null)],null),this.G))};$CLJS.g.Da=function(){return new $CLJS.es(this,2,new $CLJS.Q(null,2,5,$CLJS.R,[$CLJS.pj,$CLJS.Vy],null),$CLJS.n(this.G)?$CLJS.sc(this.G):$CLJS.Ke())};$CLJS.g.O=function(){return this.T};
$CLJS.g.ha=function(){return 2+$CLJS.D(this.G)};$CLJS.g.fa=function(){var a=this.J;return null!=a?a:this.J=a=-884441273^$CLJS.Rc(this)};$CLJS.g.V=function(a,b){return null!=b&&this.constructor===b.constructor&&$CLJS.E.g(this.tag,b.tag)&&$CLJS.E.g(this.source,b.source)&&$CLJS.E.g(this.G,b.G)};
$CLJS.g.Gb=function(a,b){return $CLJS.Jd(new $CLJS.ch(null,new $CLJS.h(null,2,[$CLJS.Vy,null,$CLJS.pj,null],null),null),b)?$CLJS.ak.g($CLJS.Pb($CLJS.gg.g($CLJS.N,this),this.T),b):new X$(this.tag,this.source,this.T,$CLJS.Ie($CLJS.ak.g(this.G,b)),null)};$CLJS.g.Va=function(a,b){switch(b instanceof $CLJS.M?b.S:null){case "tag":case "source":return!0;default:return $CLJS.Jd(this.G,b)}};
$CLJS.g.ma=function(a,b,c){return $CLJS.n($CLJS.je.g?$CLJS.je.g($CLJS.pj,b):$CLJS.je.call(null,$CLJS.pj,b))?new X$(c,this.source,this.T,this.G,null):$CLJS.n($CLJS.je.g?$CLJS.je.g($CLJS.Vy,b):$CLJS.je.call(null,$CLJS.Vy,b))?new X$(this.tag,c,this.T,this.G,null):new X$(this.tag,this.source,this.T,$CLJS.T.j(this.G,b,c),null)};$CLJS.g.ga=function(){return $CLJS.y($CLJS.jf.g(new $CLJS.Q(null,2,5,$CLJS.R,[new $CLJS.$f($CLJS.pj,this.tag),new $CLJS.$f($CLJS.Vy,this.source)],null),this.G))};
$CLJS.g.P=function(a,b){return new X$(this.tag,this.source,b,this.G,this.J)};$CLJS.g.ja=function(a,b){return $CLJS.Ad(b)?this.ma(null,$CLJS.ld(b,0),$CLJS.ld(b,1)):$CLJS.fb($CLJS.qb,this,b)};var Mya=/\[\[.+\]\]/,Nya=/\[\[(.+?)\]\]/,$$=function $$(a){switch(arguments.length){case 2:return $$.g(arguments[0],arguments[1]);case 4:return $$.v(arguments[0],arguments[1],arguments[2],arguments[3]);default:throw Error(["Invalid arity: ",$CLJS.p.h(arguments.length)].join(""));}};
$CLJS.Aa("metabase.shared.parameters.parameters.substitute_tags",$$);$$.g=function(a,b){return $$.v(a,b,"en",!0)};$$.v=function(a,b,c,d){return $CLJS.n(a)?(b=$CLJS.Iy(b),b=$CLJS.fs(b,Pya),Oya(Kya(Lya(b,c,d,Jya(a))))):null};$$.A=4;module.exports={tag_names:function(a){a=$CLJS.hh($CLJS.kf.g($CLJS.id,$CLJS.SV(Y$,$CLJS.n(a)?a:"")));return $CLJS.Bk(a)},substitute_tags:$$};